<Window x:Class="JulioCode01.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:JulioCode01.Views"
        xmlns:viewModels="clr-namespace:JulioCode06.ViewModels;assembly=JulioCode06.ViewModels"
        mc:Ignorable="d"
        d:DataContext="{d:DesignInstance Type=viewModels:MainViewModel, IsDesignTimeCreatable=False}"
        Title="MainWindow" Height="450" Width="800">
    <Window.Resources>
        <local:BooleanToStringConverter x:Key="BooleanToStringConverter" />
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="50"/>
            <RowDefinition Height="100*"/>
            <RowDefinition Height="50"/>
        </Grid.RowDefinitions>
        <Button Content="Load trades" Command="{Binding LoadTradeCommand}" 
                IsEnabled="{Binding IsLoading, Converter={StaticResource BooleanToStringConverter}, ConverterParameter=False|True }"
                HorizontalAlignment="Left" Margin="10"  VerticalAlignment="Center"/>
        <ComboBox Grid.Row="0" Text="Currency filter" ItemsSource="{Binding CurrencyListFilter}" 
                  SelectedValue="{Binding SelectedFilter }" DisplayMemberPath="."
                  HorizontalAlignment="Right" Width="200"  VerticalAlignment="Top" />
        <DataGrid x:Name="TradesGrid" Grid.Row="1" ItemsSource="{Binding TradesView}" AutoGenerateColumns="False" >
            <DataGrid.Columns>
                <DataGridTextColumn Header="TradeId" Binding="{Binding TradeId}" MinWidth="100" Width="auto"/>
                <DataGridTextColumn Header="Type" Binding="{Binding Type}" MinWidth="100" Width="auto"/>
                <DataGridTextColumn  Binding="{Binding Currency}" MinWidth="100" Width="auto" >
                    <DataGridTextColumn.HeaderTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="30"/>
                                </Grid.ColumnDefinitions>
                                <Label Grid.Column="0" Content="Currency" MinWidth="100" Width="auto"/>
                                <Expander Grid.Column="1" ExpandDirection="Down" >
                                    <StackPanel Orientation="Vertical">
                                        <TextBlock Text="WIP" Foreground="Red"></TextBlock>
                                        <ComboBox DataContext="{Binding ElementName=TradesGrid, Path=DataContext}" ItemsSource="{Binding CurrencyListFilter}"
                                                  SelectedValue="{Binding SelectedFilter }" DisplayMemberPath="."
                                            />
                                    </StackPanel>
                                </Expander>
                            </Grid>
                        </DataTemplate>

                    </DataGridTextColumn.HeaderTemplate>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Amount" Binding="{Binding Amount, StringFormat='{}{0:c}'}" MinWidth="100" Width="auto"  />
                <DataGridTextColumn Header="Maturity Date" Binding="{Binding MaturityDate, StringFormat={}{0:yyyy-mm-dd}}" MinWidth="100" Width="auto"  />
            </DataGrid.Columns>
        </DataGrid>
        <!--<TextBlock Grid.Row="1" Text="Is Busy" FontSize="50" VerticalAlignment="Center" HorizontalAlignment="Center" Visibility="{Binding BusyIndicatorVisibility}" />-->
        <Image x:Name="BusyIndicator" Source="/JulioCode01.Views;component/Images/CIBC logo transparent.png" Grid.Row="1"  VerticalAlignment="Center" HorizontalAlignment="Center" Height="50" Visibility="{Binding IsLoading
            , Converter={StaticResource BooleanToStringConverter}, ConverterParameter=Visible|Collapsed }" RenderTransformOrigin="0.5, 0.5" >
            <Image.RenderTransform>
                <RotateTransform />
            </Image.RenderTransform>
            <Image.Triggers>
                <EventTrigger RoutedEvent="Loaded">
                    <BeginStoryboard>
                        <Storyboard RepeatBehavior="Forever">
                            <DoubleAnimation Storyboard.TargetName="BusyIndicator" 
                                             Storyboard.TargetProperty="(Button.RenderTransform).(RotateTransform.Angle)" 
                                             From="0" To="360" 
                                             Duration="0:0:5" BeginTime="0:0:0"/>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
            </Image.Triggers>
        </Image>
    </Grid>
</Window>
<!--<DoubleAnimation Storyboard.TargetName="BusyIndicator" 
                 Storyboard.TargetProperty="Width" From="50" To="150" 
                 Duration="0:0:1" BeginTime="0:0:0"/>
-->
<!--<DoubleAnimation Storyboard.TargetName="BusyIndicator" 
                 Storyboard.TargetProperty="Height" From="1" To="250" 
                 Duration="0:0:1" BeginTime="0:0:1"/>
<DoubleAnimation Storyboard.TargetName="BusyIndicator" 
                 Storyboard.TargetProperty="Height" From="250" 
                 To="1" Duration="0:0:1" BeginTime="0:0:2"/>-->
<!--
<DoubleAnimation Storyboard.TargetName="BusyIndicator" 
                 Storyboard.TargetProperty="Width" From="150" To="50" 
                 Duration="0:0:1" BeginTime="0:0:1"/>-->
